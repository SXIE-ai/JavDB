#!name=QQ音乐调试版
#!desc=专门解决Cookie获取问题的调试版本
#!author=SXIE-ai
#!homepage=https://github.com/SXIE-ai/Loon
#!icon=https://y.qq.com/favicon.ico
#!openUrl=https://github.com/SXIE-ai/Loon
#!tag=调试,Cookie
#!system=iOS
#!system_version=15
#!date=2024-01-20
#!version=debug.3.0
#!loon_version=3.2.0

[General]
name = QQ音乐调试版
author = SXIE-ai
desc = Cookie获取调试版本
version = debug.3.0
enabled = true
hide-vpn-icon = false
platform = ios
min-loon-version = 3.2.0
min-ios-version = 15.0

[Script]
# Cookie获取测试（详细日志）
http-request ^https?://(y|c|u)\.qq\.com/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusicDebug.plugin/qqmusic_debug.js, tag=QQ音乐Cookie调试, requires-body=true, argument=capture

# 环境测试
http-request ^https?://test\.qqmusic\.local/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusicDebug.plugin/qqmusic_debug.js, tag=环境测试, argument=test

# MitM测试
http-request ^https?://mitm\.qqmusic\.local/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusicDebug.plugin/qqmusic_debug.js, tag=MitM测试, argument=mitm

# 存储测试
http-request ^https?://storage\.qqmusic\.local/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusicDebug.plugin/qqmusic_debug.js, tag=存储测试, argument=storage

# 手动获取Cookie
http-request ^https?://getcookie\.qqmusic\.local/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusicDebug.plugin/qqmusic_debug.js, tag=手动获取Cookie, argument=getcookie

# 查看当前Cookie
http-request ^https?://showcookie\.qqmusic\.local/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusicDebug.plugin/qqmusic_debug.js, tag=查看Cookie, argument=showcookie

[MITM]
# 完整的QQ音乐域名列表
hostname = 
  y.qq.com,
  c.y.qq.com,
  u.y.qq.com,
  *.qq.com,
  *.tencent.com,
  *.music.qq.com,
  *.y.qq.com,
  *.qpic.cn,
  *.gtimg.cn,
  
skip-server-cert-verify = true
enable-http2 = true
enable-quic-fallback = true
force-sni-domain-name = false

# 重要：启用所有相关功能
enable = true
tls-cert-alias = QQMusic-Debug