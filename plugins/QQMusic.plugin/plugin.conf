#!name=QQ音乐签到（统一版）
#!desc=同时支持单账号和多账号模式的QQ音乐自动签到插件\n自动检测和迁移现有账号数据
#!author=SXIE-ai
#!homepage=https://github.com/SXIE-ai/Loon
#!icon=https://y.qq.com/favicon.ico
#!openUrl=https://github.com/SXIE-ai/Loon
#!tag=签到,音乐,统一版
#!system=iOS
#!system_version=15
#!date=2024-01-20
#!version=3.0.0
#!loon_version=3.2.0
#!update_url=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusicUniversal.plugin/plugin.conf

[General]
name = QQ音乐签到（统一版）
author = SXIE-ai
desc = 统一版QQ音乐插件，支持单账号/多账号
version = 3.0.0
enabled = true
hide-vpn-icon = false
platform = ios
min-loon-version = 3.2.0
min-ios-version = 15.0

[Argument]
# 运行模式选择
run_mode=select, "auto", "single", "multi", tag=运行模式, desc=auto:自动检测 single:单账号模式 multi:多账号模式
# 功能开关
cookie_switch=switch, true, false, tag=Cookie获取, desc=是否自动获取Cookie
notification_switch=switch, true, false, tag=通知开关, desc=是否显示通知
vip_switch=switch, true, false, tag=VIP签到, desc=是否执行VIP签到
# 时间设置
checkin_time=select, "09:10", "08:00", "10:00", "12:00", "14:00", "16:00", "18:00", "20:00", "22:00", tag=签到时间, desc=每日自动签到时间

[Script]
# 定时签到（使用配置的时间）
cron "{{checkin_time}}" script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusicUniversal.plugin/qqmusic_universal.js, timeout=300, tag=QQ音乐自动签到, argument=auto&mode={{run_mode}}

# 自动获取Cookie
http-request ^https?://(y|c|u)\.qq\.com/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusicUniversal.plugin/qqmusic_universal.js, tag=QQ音乐Cookie获取, requires-body=true, argument=cookie&mode={{run_mode}}, enabled={{cookie_switch}}

# 状态面板
panel = script-name=QQ音乐签到, script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusicUniversal.plugin/qqmusic_universal.js, update-interval=3600, argument=panel&mode={{run_mode}}

# 手动触发
http-request ^https?://trigger\.qqmusic\.local/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusicUniversal.plugin/qqmusic_universal.js, tag=QQ音乐手动签到, argument=manual&mode={{run_mode}}

# 数据管理
http-request ^https?://manage\.qqmusic\.local/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusicUniversal.plugin/qqmusic_universal.js, tag=QQ音乐数据管理, argument=manage

# 迁移工具
http-request ^https?://migrate\.qqmusic\.local/ script-path=https://raw.githubusercontent.com/SXIE-ai/Loon/main/plugins/QQMusicUniversal.plugin/qqmusic_universal.js, tag=QQ音乐数据迁移, argument=migrate

[MITM]
hostname = y.qq.com, c.y.qq.com, u.y.qq.com, *.qq.com
skip-server-cert-verify = true
enable-http2 = true
enable-quic-fallback = true